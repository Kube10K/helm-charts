# node-local-dns

![Version: 0.0.2](https://img.shields.io/badge/Version-0.0.2-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: latest](https://img.shields.io/badge/AppVersion-latest-informational?style=flat-square)

NodeLocal DNS Cache helm chart

## Source Code

* <https://github.com/kubernetes/kubernetes/tree/master/cluster/addons/dns/nodelocaldns>

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| config | object | `{"clusterDnsIp":"172.20.0.10","localDnsIp":"169.254.20.10","zones":[{"plugins":{"cache":{"denial":{"size":9984,"ttl":5},"success":{"size":9984,"ttl":30}},"debug":false,"errors":true,"forward":{"force_tcp":true,"parameters":"__PILLAR__CLUSTER__DNS__"},"health":true,"prometheus":true,"reload":true},"zone":"cluster.local:53"},{"plugins":{"cache":{"parameters":30},"debug":false,"errors":true,"forward":{"force_tcp":true,"parameters":"__PILLAR__CLUSTER__DNS__"},"prometheus":true,"reload":true},"zone":"in-addr.arpa:53"},{"plugins":{"cache":{"parameters":30},"debug":false,"errors":true,"forward":{"force_tcp":true,"parameters":"__PILLAR__CLUSTER__DNS__"},"prometheus":true,"reload":true},"zone":"ip6.arpa:53"},{"plugins":{"cache":{"denial":{},"parameters":30,"prefetch":{},"serve_stale":false,"success":{}},"debug":false,"errors":true,"forward":{"expire":"","force_tcp":false,"health_check":"","max_fails":"","parameters":"__PILLAR__UPSTREAM__SERVERS__","policy":"","prefer_udp":false},"prometheus":true,"reload":true},"zone":".:53"}]}` | (`map`) This config blob is turned into the fairly complex coredns node-cache configuration file. As of 8/10/2022, this file is a near perfect replica of the documentation and example at https://github.com/kubernetes/kubernetes/blob/4c43287ffee19405849924fb689a4cabdfe3e438/cluster/addons/dns/nodelocaldns/nodelocaldns.yaml. This file is VERY sensitive, so any changes to this file LIKELY will require changes to the overall chart itself. https://kubernetes.io/docs/tasks/administer-cluster/dns-custom-nameservers/#coredns-configmap-options |
| healthPort | int | `9252` | (`int`) The port number that will be used to expose health information about the node-local-dns pods. This number must be unique to all hostNetwork:true services on the host, which is why it is configurable here. |
| image.pullPolicy | string | `"IfNotPresent"` |  |
| image.repository | string | `"registry.k8s.io/dns/k8s-dns-node-cache"` | (`string`) This is the default repository. However we cache this image in our repos with regsync (see regsync.yaml) and the bootstrap parent application overrides the image repository value. |
| image.tag | string | `"1.22.8"` | (`string`) The image version we will run. Make sure it has been replicated already by checking out `regsync.yaml`. |
| metricsPort | int | `9253` | (`int`) The port number that is used to expose custom metrics to prometheus for monitoring. This port must also be unique among all of the pods on the host that are running with hostNetwork:true. |
| nodeSelector | object | `{}` | (`map`) Map that controls which nodes this daemonset is applied to. |
| podAnnotations | object | `{}` | (`map`) Annotations to add to the Pods themselves. |
| podSecurityContext | object | `{}` | (`map`)` SecurityContext to be set on the pod itself. |
| priorityClassName | string | `"system-node-critical"` | (`string`) Ensure that these pods have the highest priority possible. |
| resources | object | `{"requests":{"cpu":"30m","memory":"50Mi"}}` | (`map`) The default configuration that caches around ~10k items is supposed to use ~30Mi of memory at max according to the documentation: https://kubernetes.io/docs/tasks/administer-cluster/nodelocaldns/#setting-memory-limits |
| serviceAccount.annotations | object | `{}` | (`map`) Annotations to add to the ServiceAccount. |
| serviceAccount.create | bool | `true` | (`bool`) Whether or not to create the node-local-dns ServiceAccount. |
| serviceAccount.name | string | `""` | (`string`) Optional hard-coded override for the name of the ServiceAccount. |
| tolerations | list | `[{"key":"CriticalAddonsOnly","operator":"Exists"},{"effect":"NoExecute","operator":"Exists"},{"effect":"NoSchedule","operator":"Exists"}]` | (`map`) Configures which tolerations this pod will accept. By default we accept ALL because this is a core critical system pod that should run everywhere. |
| updateStrategy | object | `{"rollingUpdate":{"maxUnavailable":"10%"}}` | (`map`) Configure the deployment strategy for the pods, to ensure we don't roll out too many at once. |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs v1.5.0](https://github.com/norwoodj/helm-docs/releases/v1.5.0)
